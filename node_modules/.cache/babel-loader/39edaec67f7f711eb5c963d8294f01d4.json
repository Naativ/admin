{"remainingRequest":"/Users/narfdre/Code/hexly/admin/node_modules/babel-loader/lib/index.js!/Users/narfdre/Code/hexly/admin/node_modules/eslint-loader/index.js??ref--13-0!/Users/narfdre/Code/hexly/admin/src/views/users/TeamGraph.d3.js","dependencies":[{"path":"/Users/narfdre/Code/hexly/admin/src/views/users/TeamGraph.d3.js","mtime":1570835920000},{"path":"/Users/narfdre/Code/hexly/admin/.babelrc","mtime":1546923832000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/web.dom.iterable\";\nimport * as d3 from 'd3';\nimport contextMenu from 'd3-context-menu'; // Display Variables\n\nvar width = 1000;\nvar height = 400;\nvar imageRadius = 20;\nvar duration = 750;\nvar zoomDuration = 10;\nvar radius = 150;\nvar radiusRatio = 6.66;\nvar svg, pinImage;\nvar vueControls;\nvar menuFunc;\nvar pressed;\nvar textPadding = 5;\nvar textSize = 12;\nvar inTransition = false;\nvar zoomer, svgContainer;\nvar radialTree = d3.tree().size([360, radius]).separation(function (a, b) {\n  return (a.parent === b.parent ? 1 : 2) / a.depth;\n});\nvar zoom = d3.zoom().scaleExtent([0.1, 3]).on('zoom', zoomed);\n\nfunction zoomed() {\n  svg.attr('transform', d3.event.transform);\n}\n\nfunction centerMember(source, graphType) {\n  var x, y;\n\n  if (graphType === 'HT') {\n    x = -source.y0 + width / 3;\n    y = -source.x0 + height / 2;\n  } else if (graphType === 'VT') {\n    x = -source.x0 + width / 2;\n    y = -source.y0 + height / 2 - 20;\n  } else if (graphType === 'RT') {\n    x = -project(source.x0, source.y0)[0] + width / 2;\n    y = -project(source.x0, source.y0)[1] + height / 2;\n  }\n\n  zoomer.transition().duration(duration).call(zoom.transform, d3.zoomIdentity.translate(x, y).scale(1));\n}\n\nfunction zoomInAndOut(_ref) {\n  var amount = _ref.amount;\n  zoomer.transition().duration(zoomDuration).call(zoom.scaleBy, amount).on('end', function () {\n    if (pressed) zoomInAndOut({\n      amount: amount\n    });\n  }); // call(firstArg: function, remainingArgs: args for function)\n}\n\nfunction panAround(_ref2) {\n  var x = _ref2.x,\n      y = _ref2.y;\n  zoomer.transition().duration(zoomDuration).call(zoom.translateBy, x, y).on('end', function () {\n    if (pressed) panAround({\n      x: x,\n      y: y\n    });\n  }); // call(firstArg: function, remainingArgs: args for function)\n}\n\nvar initializerExported = function initializerExported(cfg, data) {\n  menuFunc = cfg.contextMenuFunc;\n  vueControls = cfg;\n  svgContainer = d3.select(cfg.el).append(\"svg\").attr(\"viewBox\", \"0 0 \".concat(width, \" \").concat(height)).attr(\"width\", \"75%\").style(\"margin-left\", \"12.5%\").on(\"contextmenu\", function () {\n    return d3.event.preventDefault();\n  });\n  zoomer = svgContainer.append('rect').attr('width', width).attr('height', height).style('fill', 'none').style('pointer-events', 'all').call(zoom).on(\"dblclick.zoom\", null);\n  svg = svgContainer.append(\"g\").attr(\"id\", \"graph\"); // Append the image of the pin to the svg\n\n  pinImage = svg.append(\"image\").attr(\"class\", \"pinImage\").attr(\"xlink:href\", \"/img/icons/pin.svg\").style(\"opacity\", \"0\");\n  loadGraph({\n    fetchedData: data,\n    graphType: vueControls.getGraphType()\n  });\n  var graphControl = {\n    zoomInAndOut: zoomInAndOut,\n    panAround: panAround,\n    update: update,\n    updatePinned: updatePinned,\n    loadGraph: loadGraph,\n    centerMember: centerMember,\n    changeGraphType: changeGraphType\n  };\n  return graphControl;\n};\n\nvar loadGraph = function loadGraph(_ref3) {\n  var fetchedData = _ref3.fetchedData,\n      graphType = _ref3.graphType;\n  var root = d3.hierarchy(fetchedData, function (d) {\n    return d.children;\n  });\n\n  if (graphType === 'HT') {\n    root.x0 = height / 2;\n    root.y0 = 0;\n  } else if (graphType === 'VT') {\n    root.x0 = 0;\n    root.y0 = width / 2;\n  } else if (graphType === 'RT') {\n    root.x0 = 0;\n    root.y0 = 0;\n  } // Collapse after the first level\n\n\n  collapse(root);\n  vueControls.setRoot(root);\n  update({\n    source: vueControls.getRoot(),\n    center: true,\n    graphType: graphType\n  });\n  zoomControls();\n  panControls();\n  createMemberDetails();\n};\n\nvar changeGraphType = function changeGraphType(root, graphType) {\n  if (graphType === 'HT') {\n    root.x0 = height / 2;\n    root.y0 = 0;\n  } else if (graphType === 'VT') {\n    root.x0 = 0;\n    root.y0 = width / 2;\n  } else if (graphType === 'RT') {\n    root.x0 = 0;\n    root.y0 = 0;\n  } // Clear the graph so the new graph changes take effect\n\n\n  svg.selectAll('g.node').data([]).exit().remove();\n  collapse(root);\n  vueControls.setRoot(root);\n  if (graphType === 'RT') vueControls.setRadialRoot(root);\n}; // ------------------- Updates ------------------------\n\n\nfunction update(_ref4) {\n  var source = _ref4.source,\n      pinned = _ref4.pinned,\n      firstPin = _ref4.firstPin,\n      center = _ref4.center,\n      graphType = _ref4.graphType,\n      updateHeight = _ref4.updateHeight;\n  if (updateHeight) updateHeightDepth(graphType !== 'RT' ? vueControls.getRoot() : vueControls.getRadialRoot(), 0);\n  var newHeight = Math.max(vueControls.getRoot().descendants().reverse().length * (3 * imageRadius), height);\n  var treemap;\n  if (graphType !== 'RT') treemap = d3.tree().size([newHeight, width]);else {\n    var radialRoot = vueControls.getRadialRoot();\n    var childrenRadius = radialRoot.children ? radialRoot.children.length * radiusRatio : 0;\n    treemap = radialTree.size([360, Math.max(radius, childrenRadius)]);\n  } // Assigns the x and y position for the nodes\n\n  var treeData = treemap(graphType !== 'RT' ? vueControls.getRoot() : vueControls.getRadialRoot()); // Compute the new tree layout.\n\n  var nodes = treeData.descendants();\n  var links = treeData.descendants().slice(1);\n\n  if (graphType !== 'RT') {\n    nodes.forEach(function (d) {\n      if (graphType === 'HT') {\n        return d.y = d.depth * width / 4;\n      } else if (graphType === 'VT') {\n        return d.y = d.depth * 150;\n      }\n    });\n  } // ****************** Nodes ***************************\n  // Update the nodes...\n\n\n  var node = svg.selectAll(\"g.node\").data(nodes, function (d) {\n    return d.data.data.memberId;\n  });\n  updateNodes(source, node, graphType); // ****************** Links ***************************\n  // Update the links...\n\n  var link = svg.selectAll(\"path.link\").data(links, function (d) {\n    return d.data.data.memberId;\n  });\n  updateLinks(source, link, graphType);\n  updatePinned(pinned, firstPin, graphType); // Store the old positions for transition.\n\n  nodes.forEach(function (d) {\n    d.x0 = d.x;\n    d.y0 = d.y;\n  });\n  if (center) centerMember(source, graphType);\n}\n\nfunction updateNodes(source, node, graphType) {\n  // Enter any new nodes at the parent`s previous position.\n  var nodeEnter = node.enter().insert(\"g\", \"g\").attr(\"class\", \"node\").attr(\"transform\", function (d) {\n    if (graphType === 'HT') {\n      return \"translate(\" + source.y0 + \",\" + source.x0 + \")\";\n    } else if (graphType === 'VT') {\n      return \"translate(\" + source.x0 + \",\" + source.y0 + \")\";\n    } else if (graphType === 'RT') {\n      return \"translate(\".concat(project(source.x0, source.y0), \")\");\n    }\n  });\n\n  if (graphType === 'RT') {\n    nodeEnter.append('circle').attr('r', imageRadius / 2).attr('class', 'parentCircle').attr('cx', -imageRadius).attr('cy', -imageRadius).attr('style', function (d) {\n      return \"display: \".concat(d.data.id === vueControls.getRadialRoot().data.id && d.parent ? 'show' : 'none');\n    }).on('click', function (d, i) {\n      if (!inTransition && !vueControls.getLoading()) {\n        vueControls.clickNode(d, i);\n      }\n    }).attr('cursor', 'pointer');\n  } // add picture\n\n\n  var defs = nodeEnter.append('defs');\n  defs.append('clipPath').attr('id', function (d) {\n    return 'ImagePath';\n  }).append('circle').attr('r', imageRadius).attr('cx', 0).attr('cy', 0);\n  defs.append('clipPath').attr('id', function (d) {\n    return 'rankPath';\n  }).append('circle').attr('r', imageRadius / 2).attr('cx', imageRadius / 2).attr('cy', imageRadius / 2);\n  nodeEnter.append(\"circle\").attr(\"class\", 'imgCircle').attr(\"r\", 1e-6).style('fill', function (d) {\n    return \"#fff)\";\n  });\n  nodeEnter.append('image').attr('x', -imageRadius).attr('y', -imageRadius).attr('class', 'pic').attr('width', 1e-6).attr('height', 1e-6).attr('xlink:href', function (d) {\n    return d.data.data.profileUrl || '';\n  }).attr('clip-path', function (d) {\n    return \"url(#ImagePath)\";\n  }); // Logo Circle's for the nodes\n  // nodeEnter\n  //   .append('circle')\n  //   .attr('class', 'rankCircle')\n  //   .attr('r', 1e-6)\n  //   .attr('cx', imageRadius / 2 + 5)\n  //   .attr('cy', imageRadius / 2 + 5)\n  //   .style('fill', d => {\n  //     // return vueControls.ranks[`${d.data.data.values.rank}`].color\n  //     return 'blue'\n  //   })\n  // nodeEnter\n  //   .append('image')\n  //   .attr('class', 'rank')\n  //   .attr('x', 0)\n  //   .attr('y', 0)\n  //   .attr('width', 1e-6)\n  //   .attr('height', 1e-6)\n  //   .attr('xlink:href', d => d.data.data.values.imageUrl || '')\n  //   .attr('clip-path', 'url(#rankPath)')\n  // Add Circle for the click actions\n\n  nodeEnter.append('circle').attr('class', \"actionCircle\").attr(\"fill\", \"rgba(0,0,0,0)\").attr(\"r\", 1e-6).on('click', function (d, i) {\n    if (!inTransition && !vueControls.getLoading()) {\n      vueControls.clickNode(d, i);\n    }\n  }).on(\"contextmenu\", function (d, i) {\n    if (!inTransition && !vueControls.getLoading()) {\n      contextMenu(menuFunc(d))(d, i);\n    }\n  }).on(\"mouseover\", function (d) {\n    var bbox = this.getBBox();\n    var middleX = bbox.x + bbox.width;\n    var middleY = bbox.y - bbox.height; // generate a conversion function\n\n    var convert = makeAbsoluteContext(this, svgContainer.node()); // use it to calculate the absolute center of the element\n\n    var absoluteCenter = convert(middleX, middleY);\n    updateMemberDetails(d, absoluteCenter);\n  }).on(\"mouseout\", function () {\n    d3.select('g.infoContainer').attr(\"display\", \"none\");\n  });\n  var textGroup = nodeEnter.append(\"g\").attr(\"class\", \"textGroup\").attr(\"transform\", \"translate(0, 35)\");\n  textGroup.append(\"rect\").attr(\"class\", 'memberHighlight').attr(\"display\", function (d) {\n    return d.data.data.displayName.includes(vueControls.getSearchTerm()) ? \"show\" : \"none\";\n  }).attr(\"height\", 12).attr(\"width\", 0).attr('x', function (d) {\n    return graphType !== 'RT' ? 0 : d.x < 180 ? imageRadius * 2 : -(imageRadius * 2);\n  }).attr(\"y\", function () {\n    return graphType !== 'RT' ? -10 : -8;\n  });\n\n  if (graphType === 'HT') {\n    // Add labels for the nodes\n    textGroup.append(\"text\").attr('class', \"name\").attr(\"text-anchor\", function (d) {\n      return \"middle\";\n    }).text(function (d) {\n      return d.data.data.displayName;\n    }).on('click', function (d, i) {\n      if (!inTransition && !vueControls.getLoading()) {\n        vueControls.clickNode(d, i);\n      }\n    }).attr('cursor', 'pointer');\n  } else if (graphType === 'VT') {\n    // Add labels for the nodes\n    textGroup.append(\"text\").attr('class', \"firstname\").attr(\"text-anchor\", function (d) {\n      return \"middle\";\n    }).text(function (d) {\n      return d.data.data.displayName.split(' ')[0];\n    }).on('click', function (d, i) {\n      if (!inTransition && !vueControls.getLoading()) {\n        vueControls.clickNode(d, i);\n      }\n    }).attr('cursor', 'pointer'); // Add labels for the nodes\n\n    textGroup.append(\"text\").attr('class', \"lastname\").attr(\"text-anchor\", function (d) {\n      return \"middle\";\n    }).attr('y', 12).text(function (d) {\n      var name = d.data.data.displayName.split(' ');\n      return name[name.length - 1];\n    }).on('click', function (d, i) {\n      if (!inTransition && !vueControls.getLoading()) {\n        vueControls.clickNode(d);\n      }\n    }).attr('cursor', 'pointer');\n  } else if (graphType === 'RT') {\n    textGroup.attr('transform', function (d) {\n      return \"translate(0,0) rotate(\".concat(d.x < 180 ? d.x - 90 : d.x + 90, \")\");\n    });\n    textGroup.append('text').attr('class', 'name').attr('dy', '.31em').text(function (d) {\n      return d.data.data.displayName;\n    }).on('click', function (d, i) {\n      if (!inTransition && !vueControls.getLoading()) {\n        vueControls.clickNode(d, i);\n      }\n    }).attr('cursor', 'pointer');\n  }\n\n  nodeEnter.selectAll(\"rect.memberHighlight\").attr('height', function () {\n    return this.parentNode.getBBox().height;\n  }); // createMemberDetails(nodeEnter)\n  // UPDATE\n\n  var nodeUpdate = nodeEnter.merge(node);\n  inTransition = true; // Transition to the proper position for the node\n\n  nodeUpdate.transition().duration(duration).attr(\"transform\", function (d) {\n    if (graphType === 'HT') {\n      return \"translate(\" + d.y + \",\" + d.x + \")\";\n    } else if (graphType === 'VT') {\n      return \"translate(\" + d.x + \",\" + d.y + \")\";\n    } else if (graphType === 'RT') {\n      return \"translate(\".concat(project(d.x, d.y), \")\");\n    }\n  }).on(\"end\", function () {\n    inTransition = false;\n    nodeUpdate.select('circle.actionCircle').attr(\"r\", imageRadius + 2).attr(\"cursor\", \"pointer\");\n  }); // nodeUpdate\n  //   .select(`text.name`)\n  //   .attr(`text-anchor`, d => `middle`)\n  //   .text(d => d.data.data.displayName)\n  // Update the node attributes and style\n\n  nodeUpdate.select(\"circle.imgCircle\").attr(\"r\", imageRadius + 1);\n  nodeUpdate.select('circle.parentCircle').attr('style', function (d) {\n    return \"display: \".concat(d.data.id === vueControls.getRadialRoot().data.id && d.parent ? 'show' : 'none');\n  }); // nodeUpdate.select(`circle.rankCircle`).attr(`r`, imageRadius / 2 + 1)\n\n  nodeUpdate.select('image.pic').attr('height', imageRadius * 2).attr('width', imageRadius * 2).attr('cursor', 'pointer');\n\n  if (graphType === 'HT') {\n    textGroup = nodeUpdate.selectAll('g.textGroup').transition().duration(duration).attr(\"transform\", \"translate(0, 35)\");\n    textGroup.select('text.name').transition().duration(duration).attr(\"text-anchor\", function (d) {\n      return \"middle\";\n    }).attr('x', 0);\n  } else if (graphType === 'VT') {\n    textGroup = nodeUpdate.selectAll('g.textGroup').transition().duration(duration).attr(\"transform\", \"translate(0, 35)\");\n    textGroup.select('text.firstname').attr(\"text-anchor\", function (d) {\n      return \"middle\";\n    });\n    textGroup.select('text.lastname').attr(\"text-anchor\", function (d) {\n      return \"middle\";\n    }); // textGroup.select('text.name').remove()\n  } else if (graphType === 'RT') {\n    nodeUpdate.selectAll('g.textGroup').transition().duration(duration).attr('transform', function (d) {\n      return \"translate(0,0) rotate(\".concat(d.x < 180 ? d.x - 90 : d.x + 90, \")\");\n    });\n    nodeUpdate.selectAll('text.name').transition().duration(duration).attr('x', function (d) {\n      return d.x < 180 ? imageRadius + 4 : -(imageRadius + 4);\n    }).attr('text-anchor', function (d) {\n      return d.x < 180 ? 'start' : 'end';\n    }); // .attr(\n    //   'transform',\n    //   d => 'rotate(' + (d.x < 180 ? d.x - 90 : d.x + 90) + ')'\n    // )\n    // .text(d => d.data.data.displayName)\n  }\n\n  nodeUpdate.selectAll('rect.memberHighlight').attr(\"display\", function (d) {\n    return d.data.data.displayName.toLowerCase().includes(vueControls.getSearchTerm()) ? \"show\" : \"none\";\n  }).attr(\"x\", function (d) {\n    if (graphType !== 'RT') {\n      return -this.parentNode.getBBox().width / 2;\n    } else {\n      return d.x < 180 ? imageRadius + 4 : -(imageRadius + 4) + -this.parentNode.getBBox().width;\n    }\n  }).attr(\"width\", function () {\n    if (d3.select(this).attr('display') === 'none') return 0;\n    return this.parentNode.getBBox().width;\n  }); // updateMemberDetails(nodeUpdate)\n  // nodeUpdate\n  //   .select('image.rank')\n  //   .attr('height', imageRadius)\n  //   .attr('width', imageRadius)\n  //   .attr('cursor', 'pointer')\n  // Remove any exiting nodes\n\n  node.exit().remove();\n}\n\nfunction updateLinks(source, link, graphType) {\n  // Enter any new links at the parent`s previous position.\n  var linkEnter = link.enter().insert(\"path\", \"g\").attr(\"class\", \"link\").attr(\"d\", function (d) {\n    var o = {\n      x: source.x0,\n      y: source.y0\n    };\n    return diagonal(o, o);\n  }); // UPDATE\n\n  var linkUpdate = linkEnter.merge(link); // Transition back to the parent element position\n\n  linkUpdate.transition().duration(duration).attr(\"d\", function (d) {\n    return diagonal(d, d.parent);\n  }); // Remove any exiting links\n\n  link.exit().transition().duration(duration).attr(\"d\", function (d) {\n    var o = {\n      x: source.x,\n      y: source.y\n    };\n    return diagonal(o, o);\n  }).remove(); // Creates a curved (diagonal) path from parent to the child nodes\n\n  function diagonal(s, d) {\n    var path;\n\n    if (graphType === 'HT') {\n      path = \"M \".concat(s.y, \" \").concat(s.x, \" C \").concat((s.y + d.y) / 2, \" \").concat(s.x, \", \").concat((s.y + d.y) / 2, \" \\n      \").concat(d.x, \", \").concat(d.y, \" \").concat(d.x);\n    } else if (graphType === 'VT') {\n      path = \"M \".concat(s.x, \" \").concat(s.y, \"\\n              C \").concat(s.x, \" \").concat((s.y + d.y) / 2, \",\\n                \").concat(d.x, \" \").concat((s.y + d.y) / 2, \",\\n                \").concat(d.x, \" \").concat(d.y);\n    } else if (graphType === 'RT') {\n      path = 'M' + project(s.x, s.y) + 'C' + project(s.x, (s.y + d.y) / 2) + ' ' + project(s.depth === 1 ? s.x : d.x, (s.y + d.y) / 2) + ' ' + project(s.depth === 1 ? s.x : d.x, d.y);\n    }\n\n    return path;\n  }\n}\n\nfunction project(x, y) {\n  var angle = (x - 90) / 180 * Math.PI;\n  var radius = y;\n  return [radius * Math.cos(angle), radius * Math.sin(angle)];\n}\n\nfunction createMemberDetails() {\n  var container = svgContainer.append(\"g\").attr(\"class\", \"infoContainer\").attr(\"display\", \"none\");\n  container.append(\"rect\").attr('class', \"infoRect\").attr(\"x\", \"-5\").attr(\"width\", \"180\").attr(\"height\", \"100\");\n  container.append(\"text\").attr('class', 'displayName').attr(\"text-align\", \"start\").attr(\"dy\", \"\".concat(textSize + textPadding, \"px\"));\n  container.append(\"text\").attr('class', 'teamSize').attr(\"text-align\", \"start\").attr(\"dy\", \"\".concat((textSize + textPadding) * 2, \"px\"));\n  container.append(\"text\").attr('class', 'frontLineSize').attr(\"text-align\", \"start\").attr(\"dy\", \"\".concat((textSize + textPadding) * 3, \"px\"));\n  container.append(\"text\").attr('class', 'totalPoints').attr(\"text-align\", \"start\").attr(\"dy\", \"\".concat((textSize + textPadding) * 4, \"px\"));\n  container.append(\"text\").attr('class', 'totalAmount').attr(\"text-align\", \"start\").attr(\"dy\", \"\".concat((textSize + textPadding) * 5, \"px\"));\n  container.attr(\"width\", function () {\n    return this.parentNode.getBBox().width + textPadding;\n  });\n}\n\nfunction updateMemberDetails(d, position) {\n  var container = svgContainer.select('g.infoContainer').attr('transform', \"translate(\".concat(position.x, \", \").concat(position.y, \")\")).attr('display', 'show');\n  container.select('text.displayName').text(d.data.data.displayName);\n  container.select('text.teamSize').text(\"Team Size: \".concat(d.data.data.teamSize));\n  container.select('text.frontLineSize').text(\"Front Line: \".concat(d.data.data.frontLineSize));\n  container.select('text.totalPoints').text(\"Total Points: \".concat(d.data.data.totalPoints));\n  container.select('text.totalAmount').text(\"Total Amount: \".concat(d.data.data.totalAmount));\n}\n\nfunction updatePinned(pinned, firstPin) {\n  inTransition = true; // Display pin image next to pinned Node\n\n  if (pinned) {\n    if (firstPin) {\n      firstPin = !firstPin;\n      pinImage.style(\"x\", \"\".concat(pinned.y - 42, \"px\")).style(\"y\", \"\".concat(pinned.x - 42, \"px\")).transition().duration(duration).style(\"opacity\", \"1\").on(\"end\", function () {\n        inTransition = false;\n      });\n    } else {\n      pinImage.transition().duration(duration).style(\"x\", \"\".concat(pinned.y - 42, \"px\")).style(\"y\", \"\".concat(pinned.x - 42, \"px\")).on(\"end\", function () {\n        inTransition = false;\n      });\n    }\n  } else {\n    pinImage.transition().duration(duration).style(\"opacity\", \"0\").on(\"end\", function () {\n      inTransition = false;\n    });\n  }\n}\n\nfunction zoomControls() {\n  var zoomGroup = svgContainer.append('g').attr('class', 'zoomGroup').attr('transform', \"translate(\".concat(width - 5, \", 5)\"));\n  var zoomEnter = zoomGroup.selectAll('g.zoomData').data(vueControls.zoomControls).enter().append('g').attr('class', 'zoomData').attr(\"transform\", function (d, i) {\n    return \"translate(\".concat(-40 * (i + 1), \", 0)\");\n  });\n  zoomEnter.append('circle').attr(\"class\", \"controlCircle\").attr('r', 17).attr('cx', 15).attr('cy', 15) // .on('click', d => d.action(d.data))\n  .on('mousedown', function (d) {\n    pressed = true;\n    d.action(d.data);\n  }).on('mouseup', function () {\n    return pressed = false;\n  }).on('mouseout', function () {\n    return pressed = false;\n  });\n  zoomEnter.append('image').attr(\"class\", function (d) {\n    return d.option;\n  }).attr('width', 30).attr('height', 30).attr(\"preserveAspectRatio\", 'none').attr(\"xlink:href\", function (d) {\n    return d.img;\n  }) // .on('click', d => d.action(d.data))\n  .on('mousedown', function (d) {\n    pressed = true;\n    d.action(d.data);\n  }).on('mouseup', function () {\n    return pressed = false;\n  }).on('mouseout', function () {\n    return pressed = false;\n  });\n}\n\nfunction panControls() {\n  var buttonDistance = 30;\n  var panGroup = svgContainer.append('g').attr('class', 'panGroup').attr('transform', \"translate(35, \".concat(height - 65, \")\"));\n  var panEnter = panGroup.selectAll('g.panData').data(vueControls.panControls).enter().append('g').attr('class', 'panData').attr(\"transform\", function (d) {\n    return \"translate(\".concat(d.translate.x * buttonDistance, \", \").concat(d.translate.y * buttonDistance, \")\");\n  });\n  panEnter.append('circle').attr(\"class\", \"controlCircle\").attr('r', 17).attr('cx', 17).attr('cy', 17).on('mousedown', function (d) {\n    pressed = true;\n    d.action(d.data);\n  }).on('mouseup', function () {\n    return pressed = false;\n  }).on('mouseout', function () {\n    return pressed = false;\n  });\n  panEnter.append('image').attr(\"class\", function (d) {\n    return d.option;\n  }).attr('width', 34).attr('height', 34).attr(\"preserveAspectRatio\", 'none').attr(\"xlink:href\", function (d) {\n    return d.img;\n  }).on('mousedown', function (d) {\n    pressed = true;\n    d.action(d.data);\n  }).on('mouseup', function () {\n    return pressed = false;\n  }).on('mouseout', function () {\n    return pressed = false;\n  });\n}\n\nwindow.addEventListener('resize', redrawZoom);\n\nfunction redrawZoom() {\n  var svgWidth = Number(svgContainer.style(\"width\").replace('px', ''));\n  zoomer.attr('width', Math.max(svgWidth, width));\n}\n\nfunction makeAbsoluteContext(element, svgDocument) {\n  return function (x, y) {\n    var offset = svgDocument.getBoundingClientRect();\n    var matrix = element.getScreenCTM();\n    return {\n      x: matrix.a * x + matrix.c * y + matrix.e - offset.left,\n      y: matrix.b * x + matrix.d * y + matrix.f - offset.top\n    };\n  };\n} // ------------- Compution functions -------------\n\n\nfunction updateHeightDepth(current, depth) {\n  current.depth = depth;\n  var height = 0;\n\n  if (current.children) {\n    var children = current.children;\n    var heights = [];\n\n    for (var i = 0; i < children.length; ++i) {\n      heights.push(updateHeightDepth(children[i], depth + 1));\n    }\n\n    height = Math.max.apply(Math, heights.concat([height])) + 1;\n  }\n\n  current.height = height;\n  return height;\n}\n\nfunction parentOfPinned(selected, pinned, pinnedParent) {\n  if (pinned === selected || !pinnedParent) return false;else if (pinnedParent === selected) return true;else return parentOfPinned(selected, pinned, pinnedParent.parent);\n}\n\nfunction checkParentOfPinned(selected, pinned) {\n  if (pinned) return parentOfPinned(selected, pinned, pinned.parent);\n  return false;\n}\n\nfunction childOfPinned(selected, pinned) {\n  if (!selected) return false;else if (selected === pinned) return true;else return childOfPinned(selected.parent, pinned);\n} // Collapse the node and all it`s children\n\n\nfunction collapse(d) {\n  if (d.children) {\n    d._children = d.children;\n\n    d._children.forEach(collapse);\n\n    d.children = null;\n  }\n}\n\nexport { initializerExported as initialize, updateHeightDepth, collapse, checkParentOfPinned, childOfPinned };",{"version":3,"sources":["/Users/narfdre/Code/hexly/admin/src/views/users/TeamGraph.d3.js"],"names":["d3","contextMenu","width","height","imageRadius","duration","zoomDuration","radius","radiusRatio","svg","pinImage","vueControls","menuFunc","pressed","textPadding","textSize","inTransition","zoomer","svgContainer","radialTree","tree","size","separation","a","b","parent","depth","zoom","scaleExtent","on","zoomed","attr","event","transform","centerMember","source","graphType","x","y","y0","x0","project","transition","call","zoomIdentity","translate","scale","zoomInAndOut","amount","scaleBy","panAround","translateBy","initializerExported","cfg","data","contextMenuFunc","select","el","append","style","preventDefault","loadGraph","fetchedData","getGraphType","graphControl","update","updatePinned","changeGraphType","root","hierarchy","d","children","collapse","setRoot","getRoot","center","zoomControls","panControls","createMemberDetails","selectAll","exit","remove","setRadialRoot","pinned","firstPin","updateHeight","updateHeightDepth","getRadialRoot","newHeight","Math","max","descendants","reverse","length","treemap","radialRoot","childrenRadius","treeData","nodes","links","slice","forEach","node","memberId","updateNodes","link","updateLinks","nodeEnter","enter","insert","id","i","getLoading","clickNode","defs","profileUrl","bbox","getBBox","middleX","middleY","convert","makeAbsoluteContext","absoluteCenter","updateMemberDetails","textGroup","displayName","includes","getSearchTerm","text","split","name","parentNode","nodeUpdate","merge","toLowerCase","linkEnter","o","diagonal","linkUpdate","s","path","angle","PI","cos","sin","container","position","teamSize","frontLineSize","totalPoints","totalAmount","zoomGroup","zoomEnter","action","option","img","buttonDistance","panGroup","panEnter","window","addEventListener","redrawZoom","svgWidth","Number","replace","element","svgDocument","offset","getBoundingClientRect","matrix","getScreenCTM","c","e","left","f","top","current","heights","push","parentOfPinned","selected","pinnedParent","checkParentOfPinned","childOfPinned","_children","initialize"],"mappings":"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","sourcesContent":["import * as d3 from 'd3'\nimport contextMenu from 'd3-context-menu'\n// Display Variables\n\nlet width = 1000\nlet height = 400\nlet imageRadius = 20\nlet duration = 750\nlet zoomDuration = 10\nlet radius = 150\nlet radiusRatio = 6.66\n\nlet svg, pinImage\n\nlet vueControls\nlet menuFunc\nlet pressed\n\nlet textPadding = 5\nlet textSize = 12\n\nlet inTransition = false\nlet zoomer, svgContainer\n\nlet radialTree = d3\n  .tree()\n  .size([360, radius])\n  .separation(function(a, b) {\n    return (a.parent === b.parent ? 1 : 2) / a.depth\n  })\n\nvar zoom = d3\n  .zoom()\n  .scaleExtent([0.1, 3])\n  .on('zoom', zoomed)\n\nfunction zoomed() {\n  svg.attr('transform', d3.event.transform)\n}\n\nfunction centerMember(source, graphType) {\n  let x, y\n  if (graphType === 'HT') {\n    x = -source.y0 + width / 3\n    y = -source.x0 + height / 2\n  } else if (graphType === 'VT') {\n    x = -source.x0 + width / 2\n    y = -source.y0 + height / 2 - 20\n  } else if (graphType === 'RT') {\n    x = -project(source.x0, source.y0)[0] + width / 2\n    y = -project(source.x0, source.y0)[1] + height / 2\n  }\n  zoomer\n    .transition()\n    .duration(duration)\n    .call(zoom.transform, d3.zoomIdentity.translate(x, y).scale(1))\n}\n\nfunction zoomInAndOut({ amount }) {\n  zoomer\n    .transition()\n    .duration(zoomDuration)\n    .call(zoom.scaleBy, amount)\n    .on('end', () => {\n      if (pressed) zoomInAndOut({ amount })\n    })\n  // call(firstArg: function, remainingArgs: args for function)\n}\n\nfunction panAround({ x, y }) {\n  zoomer\n    .transition()\n    .duration(zoomDuration)\n    .call(zoom.translateBy, x, y)\n    .on('end', () => {\n      if (pressed) panAround({ x, y })\n    })\n  // call(firstArg: function, remainingArgs: args for function)\n}\n\nconst initializerExported = (cfg, data) => {\n  menuFunc = cfg.contextMenuFunc\n  vueControls = cfg\n\n  svgContainer = d3\n    .select(cfg.el)\n    .append(`svg`)\n    .attr(`viewBox`, `0 0 ${width} ${height}`)\n    .attr(`width`, `75%`)\n    .style(`margin-left`, `12.5%`)\n    .on(`contextmenu`, () => d3.event.preventDefault())\n\n  zoomer = svgContainer\n    .append('rect')\n    .attr('width', width)\n    .attr('height', height)\n    .style('fill', 'none')\n    .style('pointer-events', 'all')\n    .call(zoom)\n    .on(`dblclick.zoom`, null)\n\n  svg = svgContainer.append(`g`).attr(`id`, `graph`)\n\n  // Append the image of the pin to the svg\n  pinImage = svg\n    .append(`image`)\n    .attr(`class`, `pinImage`)\n    .attr(`xlink:href`, `/img/icons/pin.svg`)\n    .style(`opacity`, `0`)\n\n  loadGraph({ fetchedData: data, graphType: vueControls.getGraphType() })\n  const graphControl = {\n    zoomInAndOut,\n    panAround,\n    update,\n    updatePinned,\n    loadGraph,\n    centerMember,\n    changeGraphType\n  }\n\n  return graphControl\n}\n\nlet loadGraph = ({ fetchedData, graphType }) => {\n  let root = d3.hierarchy(fetchedData, d => d.children)\n  if (graphType === 'HT') {\n    root.x0 = height / 2\n    root.y0 = 0\n  } else if (graphType === 'VT') {\n    root.x0 = 0\n    root.y0 = width / 2\n  } else if (graphType === 'RT') {\n    root.x0 = 0\n    root.y0 = 0\n  }\n\n  // Collapse after the first level\n  collapse(root)\n\n  vueControls.setRoot(root)\n\n  update({\n    source: vueControls.getRoot(),\n    center: true,\n    graphType: graphType\n  })\n  zoomControls()\n  panControls()\n  createMemberDetails()\n}\n\nlet changeGraphType = (root, graphType) => {\n  if (graphType === 'HT') {\n    root.x0 = height / 2\n    root.y0 = 0\n  } else if (graphType === 'VT') {\n    root.x0 = 0\n    root.y0 = width / 2\n  } else if (graphType === 'RT') {\n    root.x0 = 0\n    root.y0 = 0\n  }\n  // Clear the graph so the new graph changes take effect\n  svg\n    .selectAll('g.node')\n    .data([])\n    .exit()\n    .remove()\n\n  collapse(root)\n  vueControls.setRoot(root)\n  if (graphType === 'RT') vueControls.setRadialRoot(root)\n}\n\n// ------------------- Updates ------------------------\n\nfunction update({ source, pinned, firstPin, center, graphType, updateHeight }) {\n  if (updateHeight) updateHeightDepth(graphType !== 'RT' ? vueControls.getRoot() : vueControls.getRadialRoot(), 0)\n\n  const newHeight = Math.max(\n    vueControls\n      .getRoot()\n      .descendants()\n      .reverse().length *\n      (3 * imageRadius),\n    height\n  )\n\n  let treemap\n  if (graphType !== 'RT') treemap = d3.tree().size([newHeight, width])\n  else {\n    const radialRoot = vueControls.getRadialRoot()\n    const childrenRadius = radialRoot.children ? radialRoot.children.length * radiusRatio : 0\n    treemap = radialTree.size([360, Math.max(radius, childrenRadius)])\n  }// Assigns the x and y position for the nodes\n  let treeData = treemap(\n    graphType !== 'RT' ? vueControls.getRoot() : vueControls.getRadialRoot()\n  )\n  // Compute the new tree layout.\n  let nodes = treeData.descendants()\n  let links = treeData.descendants().slice(1)\n\n  if (graphType !== 'RT') {\n    nodes.forEach(function(d) {\n      if (graphType === 'HT') {\n        return (d.y = (d.depth * width) / 4)\n      } else if (graphType === 'VT') {\n        return (d.y = d.depth * 150)\n      }\n    })\n  }\n\n  // ****************** Nodes ***************************\n\n  // Update the nodes...\n  let node = svg.selectAll(`g.node`).data(nodes, d => d.data.data.memberId)\n\n  updateNodes(source, node, graphType)\n\n  // ****************** Links ***************************\n\n  // Update the links...\n  let link = svg.selectAll(`path.link`).data(links, function(d) {\n    return d.data.data.memberId\n  })\n\n  updateLinks(source, link, graphType)\n\n  updatePinned(pinned, firstPin, graphType)\n\n  // Store the old positions for transition.\n  nodes.forEach(function(d) {\n    d.x0 = d.x\n    d.y0 = d.y\n  })\n  if (center) centerMember(source, graphType)\n}\n\nfunction updateNodes(source, node, graphType) {\n  // Enter any new nodes at the parent`s previous position.\n  let nodeEnter = node\n    .enter()\n    .insert(`g`, `g`)\n    .attr(`class`, `node`)\n    .attr(`transform`, function(d) {\n      if (graphType === 'HT') {\n        return `translate(` + source.y0 + `,` + source.x0 + `)`\n      } else if (graphType === 'VT') {\n        return `translate(` + source.x0 + `,` + source.y0 + `)`\n      } else if (graphType === 'RT') {\n        return `translate(${project(source.x0, source.y0)})`\n      }\n    })\n  if (graphType === 'RT') {\n    nodeEnter.append('circle')\n      .attr('r', imageRadius / 2)\n      .attr('class', 'parentCircle')\n      .attr('cx', -imageRadius)\n      .attr('cy', -imageRadius)\n      .attr('style', d => `display: ${d.data.id === vueControls.getRadialRoot().data.id && d.parent ? 'show' : 'none'}`)\n      .on('click', (d, i) => {\n        if (!inTransition && !vueControls.getLoading()) {\n          vueControls.clickNode(d, i)\n        }\n      })\n      .attr('cursor', 'pointer')\n  }\n\n  // add picture\n  let defs = nodeEnter.append('defs')\n\n  defs\n    .append('clipPath')\n    .attr('id', d => 'ImagePath')\n    .append('circle')\n    .attr('r', imageRadius)\n    .attr('cx', 0)\n    .attr('cy', 0)\n\n  defs\n    .append('clipPath')\n    .attr('id', d => 'rankPath')\n    .append('circle')\n    .attr('r', imageRadius / 2)\n    .attr('cx', imageRadius / 2)\n    .attr('cy', imageRadius / 2)\n\n  nodeEnter\n    .append(`circle`)\n    .attr(`class`, 'imgCircle')\n    .attr(`r`, 1e-6)\n    .style('fill', d => `#fff)`)\n\n  nodeEnter\n    .append('image')\n    .attr('x', -imageRadius)\n    .attr('y', -imageRadius)\n    .attr('class', 'pic')\n    .attr('width', 1e-6)\n    .attr('height', 1e-6)\n    .attr('xlink:href', d => d.data.data.profileUrl || '')\n    .attr('clip-path', d => `url(#ImagePath)`)\n\n  // Logo Circle's for the nodes\n  // nodeEnter\n  //   .append('circle')\n  //   .attr('class', 'rankCircle')\n  //   .attr('r', 1e-6)\n  //   .attr('cx', imageRadius / 2 + 5)\n  //   .attr('cy', imageRadius / 2 + 5)\n  //   .style('fill', d => {\n  //     // return vueControls.ranks[`${d.data.data.values.rank}`].color\n  //     return 'blue'\n  //   })\n\n  // nodeEnter\n  //   .append('image')\n  //   .attr('class', 'rank')\n  //   .attr('x', 0)\n  //   .attr('y', 0)\n  //   .attr('width', 1e-6)\n  //   .attr('height', 1e-6)\n  //   .attr('xlink:href', d => d.data.data.values.imageUrl || '')\n  //   .attr('clip-path', 'url(#rankPath)')\n\n  // Add Circle for the click actions\n  nodeEnter\n    .append('circle')\n    .attr('class', `actionCircle`)\n    .attr(`fill`, `rgba(0,0,0,0)`)\n    .attr(`r`, 1e-6)\n    .on('click', (d, i) => {\n      if (!inTransition && !vueControls.getLoading()) {\n        vueControls.clickNode(d, i)\n      }\n    })\n    .on(`contextmenu`, (d, i) => {\n      if (!inTransition && !vueControls.getLoading()) {\n        contextMenu(menuFunc(d))(d, i)\n      }\n    })\n    .on(`mouseover`, function(d) {\n      const bbox = this.getBBox()\n      const middleX = bbox.x + bbox.width\n      const middleY = bbox.y - bbox.height\n\n      // generate a conversion function\n      var convert = makeAbsoluteContext(this, svgContainer.node())\n\n      // use it to calculate the absolute center of the element\n      var absoluteCenter = convert(middleX, middleY)\n      updateMemberDetails(d, absoluteCenter)\n    })\n    .on(`mouseout`, function() {\n      d3.select('g.infoContainer').attr(`display`, `none`)\n    })\n\n  let textGroup = nodeEnter\n    .append(`g`)\n    .attr(`class`, `textGroup`)\n    .attr(`transform`, `translate(0, 35)`)\n\n  textGroup\n    .append(`rect`)\n    .attr(`class`, 'memberHighlight')\n    .attr(`display`, d => {\n      return d.data.data.displayName.includes(vueControls.getSearchTerm())\n        ? `show`\n        : `none`\n    })\n    .attr(`height`, 12)\n    .attr(`width`, 0)\n    .attr('x', d =>\n      graphType !== 'RT' ? 0 : d.x < 180 ? imageRadius * 2 : -(imageRadius * 2)\n    )\n    .attr(`y`, () => (graphType !== 'RT' ? -10 : -8))\n\n  if (graphType === 'HT') {\n    // Add labels for the nodes\n    textGroup\n      .append(`text`)\n      .attr('class', `name`)\n      .attr(`text-anchor`, d => `middle`)\n      .text(d => d.data.data.displayName)\n      .on('click', (d, i) => {\n        if (!inTransition && !vueControls.getLoading()) {\n          vueControls.clickNode(d, i)\n        }\n      })\n      .attr('cursor', 'pointer')\n  } else if (graphType === 'VT') {\n    // Add labels for the nodes\n    textGroup\n      .append(`text`)\n      .attr('class', `firstname`)\n      .attr(`text-anchor`, d => `middle`)\n      .text(d => d.data.data.displayName.split(' ')[0])\n      .on('click', (d, i) => {\n        if (!inTransition && !vueControls.getLoading()) {\n          vueControls.clickNode(d, i)\n        }\n      })\n      .attr('cursor', 'pointer')\n\n    // Add labels for the nodes\n    textGroup\n      .append(`text`)\n      .attr('class', `lastname`)\n      .attr(`text-anchor`, d => `middle`)\n      .attr('y', 12)\n      .text(d => {\n        const name = d.data.data.displayName.split(' ')\n        return name[name.length - 1]\n      })\n      .on('click', (d, i) => {\n        if (!inTransition && !vueControls.getLoading()) {\n          vueControls.clickNode(d)\n        }\n      })\n      .attr('cursor', 'pointer')\n  } else if (graphType === 'RT') {\n    textGroup.attr(\n      'transform',\n      d => `translate(0,0) rotate(${d.x < 180 ? d.x - 90 : d.x + 90})`\n    )\n    textGroup\n      .append('text')\n      .attr('class', 'name')\n      .attr('dy', '.31em')\n      .text(d => d.data.data.displayName)\n      .on('click', (d, i) => {\n        if (!inTransition && !vueControls.getLoading()) {\n          vueControls.clickNode(d, i)\n        }\n      })\n      .attr('cursor', 'pointer')\n  }\n\n  nodeEnter.selectAll(`rect.memberHighlight`).attr('height', function() {\n    return this.parentNode.getBBox().height\n  })\n\n  // createMemberDetails(nodeEnter)\n\n  // UPDATE\n  let nodeUpdate = nodeEnter.merge(node)\n\n  inTransition = true\n  // Transition to the proper position for the node\n  nodeUpdate\n    .transition()\n    .duration(duration)\n    .attr(`transform`, d => {\n      if (graphType === 'HT') {\n        return `translate(` + d.y + `,` + d.x + `)`\n      } else if (graphType === 'VT') {\n        return `translate(` + d.x + `,` + d.y + `)`\n      } else if (graphType === 'RT') {\n        return `translate(${project(d.x, d.y)})`\n      }\n    })\n    .on(`end`, () => {\n      inTransition = false\n      nodeUpdate\n        .select('circle.actionCircle')\n        .attr(`r`, imageRadius + 2)\n        .attr(`cursor`, `pointer`)\n    })\n  // nodeUpdate\n  //   .select(`text.name`)\n  //   .attr(`text-anchor`, d => `middle`)\n  //   .text(d => d.data.data.displayName)\n\n  // Update the node attributes and style\n  nodeUpdate.select(`circle.imgCircle`).attr(`r`, imageRadius + 1)\n\n  nodeUpdate.select('circle.parentCircle')\n    .attr('style', d => `display: ${d.data.id === vueControls.getRadialRoot().data.id && d.parent ? 'show' : 'none'}`)\n  // nodeUpdate.select(`circle.rankCircle`).attr(`r`, imageRadius / 2 + 1)\n\n  nodeUpdate\n    .select('image.pic')\n    .attr('height', imageRadius * 2)\n    .attr('width', imageRadius * 2)\n    .attr('cursor', 'pointer')\n\n  if (graphType === 'HT') {\n    textGroup = nodeUpdate\n      .selectAll('g.textGroup')\n      .transition()\n      .duration(duration)\n      .attr(`transform`, `translate(0, 35)`)\n\n    textGroup\n      .select('text.name')\n      .transition()\n      .duration(duration)\n      .attr(`text-anchor`, d => `middle`)\n      .attr('x', 0)\n  } else if (graphType === 'VT') {\n    textGroup = nodeUpdate\n      .selectAll('g.textGroup')\n      .transition()\n      .duration(duration)\n      .attr(`transform`, `translate(0, 35)`)\n\n    textGroup.select('text.firstname').attr(`text-anchor`, d => `middle`)\n    textGroup.select('text.lastname').attr(`text-anchor`, d => `middle`)\n    // textGroup.select('text.name').remove()\n  } else if (graphType === 'RT') {\n    nodeUpdate\n      .selectAll('g.textGroup')\n      .transition()\n      .duration(duration)\n      .attr(\n        'transform',\n        d => `translate(0,0) rotate(${d.x < 180 ? d.x - 90 : d.x + 90})`\n      )\n    nodeUpdate\n      .selectAll('text.name')\n      .transition()\n      .duration(duration)\n      .attr('x', d => (d.x < 180 ? imageRadius + 4 : -(imageRadius + 4)))\n      .attr('text-anchor', d => (d.x < 180 ? 'start' : 'end'))\n    // .attr(\n    //   'transform',\n    //   d => 'rotate(' + (d.x < 180 ? d.x - 90 : d.x + 90) + ')'\n    // )\n    // .text(d => d.data.data.displayName)\n  }\n\n  nodeUpdate\n    .selectAll('rect.memberHighlight')\n    .attr(`display`, d => {\n      return d.data.data.displayName\n        .toLowerCase()\n        .includes(vueControls.getSearchTerm())\n        ? `show`\n        : `none`\n    })\n    .attr(`x`, function(d) {\n      if (graphType !== 'RT') {\n        return -this.parentNode.getBBox().width / 2\n      } else {\n        return d.x < 180\n          ? imageRadius + 4\n          : -(imageRadius + 4) + -this.parentNode.getBBox().width\n      }\n    })\n    .attr(`width`, function() {\n      if (d3.select(this).attr('display') === 'none') return 0\n      return this.parentNode.getBBox().width\n    })\n  // updateMemberDetails(nodeUpdate)\n\n  // nodeUpdate\n  //   .select('image.rank')\n  //   .attr('height', imageRadius)\n  //   .attr('width', imageRadius)\n  //   .attr('cursor', 'pointer')\n\n  // Remove any exiting nodes\n  node.exit().remove()\n}\n\nfunction updateLinks(source, link, graphType) {\n  // Enter any new links at the parent`s previous position.\n  let linkEnter = link\n    .enter()\n    .insert(`path`, `g`)\n    .attr(`class`, `link`)\n    .attr(`d`, function(d) {\n      let o = { x: source.x0, y: source.y0 }\n      return diagonal(o, o)\n    })\n\n  // UPDATE\n  let linkUpdate = linkEnter.merge(link)\n\n  // Transition back to the parent element position\n  linkUpdate\n    .transition()\n    .duration(duration)\n    .attr(`d`, d => diagonal(d, d.parent))\n\n  // Remove any exiting links\n  link\n    .exit()\n    .transition()\n    .duration(duration)\n    .attr(`d`, function(d) {\n      let o = { x: source.x, y: source.y }\n      return diagonal(o, o)\n    })\n    .remove()\n\n  // Creates a curved (diagonal) path from parent to the child nodes\n  function diagonal(s, d) {\n    let path\n    if (graphType === 'HT') {\n      path = `M ${s.y} ${s.x} C ${(s.y + d.y) / 2} ${s.x}, ${(s.y + d.y) / 2} \n      ${d.x}, ${d.y} ${d.x}`\n    } else if (graphType === 'VT') {\n      path = `M ${s.x} ${s.y}\n              C ${s.x} ${(s.y + d.y) / 2},\n                ${d.x} ${(s.y + d.y) / 2},\n                ${d.x} ${d.y}`\n    } else if (graphType === 'RT') {\n      path =\n        'M' +\n        project(s.x, s.y) +\n        'C' +\n        project(s.x, (s.y + d.y) / 2) +\n        ' ' +\n        project(s.depth === 1 ? s.x : d.x, (s.y + d.y) / 2) +\n        ' ' +\n        project(s.depth === 1 ? s.x : d.x, d.y)\n    }\n\n    return path\n  }\n}\nfunction project(x, y) {\n  const angle = ((x - 90) / 180) * Math.PI\n  const radius = y\n  return [radius * Math.cos(angle), radius * Math.sin(angle)]\n}\n\nfunction createMemberDetails() {\n  let container = svgContainer\n    .append(`g`)\n    .attr(`class`, `infoContainer`)\n    .attr(`display`, `none`)\n\n  container\n    .append(`rect`)\n    .attr('class', `infoRect`)\n    .attr(`x`, `-5`)\n    .attr(`width`, `180`)\n    .attr(`height`, `100`)\n\n  container\n    .append(`text`)\n    .attr('class', 'displayName')\n    .attr(`text-align`, `start`)\n    .attr(`dy`, `${textSize + textPadding}px`)\n\n  container\n    .append(`text`)\n    .attr('class', 'teamSize')\n    .attr(`text-align`, `start`)\n    .attr(`dy`, `${(textSize + textPadding) * 2}px`)\n\n  container\n    .append(`text`)\n    .attr('class', 'frontLineSize')\n    .attr(`text-align`, `start`)\n    .attr(`dy`, `${(textSize + textPadding) * 3}px`)\n\n  container\n    .append(`text`)\n    .attr('class', 'totalPoints')\n    .attr(`text-align`, `start`)\n    .attr(`dy`, `${(textSize + textPadding) * 4}px`)\n\n  container\n    .append(`text`)\n    .attr('class', 'totalAmount')\n    .attr(`text-align`, `start`)\n    .attr(`dy`, `${(textSize + textPadding) * 5}px`)\n\n  container.attr(`width`, function() {\n    return this.parentNode.getBBox().width + textPadding\n  })\n}\n\nfunction updateMemberDetails(d, position) {\n  let container = svgContainer\n    .select('g.infoContainer')\n    .attr('transform', `translate(${position.x}, ${position.y})`)\n    .attr('display', 'show')\n  container.select('text.displayName').text(d.data.data.displayName)\n  container.select('text.teamSize').text(`Team Size: ${d.data.data.teamSize}`)\n  container\n    .select('text.frontLineSize')\n    .text(`Front Line: ${d.data.data.frontLineSize}`)\n  container\n    .select('text.totalPoints')\n    .text(`Total Points: ${d.data.data.totalPoints}`)\n  container\n    .select('text.totalAmount')\n    .text(`Total Amount: ${d.data.data.totalAmount}`)\n}\nfunction updatePinned(pinned, firstPin) {\n  inTransition = true\n  // Display pin image next to pinned Node\n  if (pinned) {\n    if (firstPin) {\n      firstPin = !firstPin\n      pinImage\n        .style(`x`, `${pinned.y - 42}px`)\n        .style(`y`, `${pinned.x - 42}px`)\n        .transition()\n        .duration(duration)\n        .style(`opacity`, `1`)\n        .on(`end`, () => {\n          inTransition = false\n        })\n    } else {\n      pinImage\n        .transition()\n        .duration(duration)\n        .style(`x`, `${pinned.y - 42}px`)\n        .style(`y`, `${pinned.x - 42}px`)\n        .on(`end`, () => {\n          inTransition = false\n        })\n    }\n  } else {\n    pinImage\n      .transition()\n      .duration(duration)\n      .style(`opacity`, `0`)\n      .on(`end`, () => {\n        inTransition = false\n      })\n  }\n}\n\nfunction zoomControls() {\n  let zoomGroup = svgContainer\n    .append('g')\n    .attr('class', 'zoomGroup')\n    .attr('transform', `translate(${width - 5}, 5)`)\n\n  let zoomEnter = zoomGroup\n    .selectAll('g.zoomData')\n    .data(vueControls.zoomControls)\n    .enter()\n    .append('g')\n    .attr('class', 'zoomData')\n    .attr(`transform`, (d, i) => `translate(${-40 * (i + 1)}, 0)`)\n\n  zoomEnter\n    .append('circle')\n    .attr(`class`, `controlCircle`)\n    .attr('r', 17)\n    .attr('cx', 15)\n    .attr('cy', 15)\n    // .on('click', d => d.action(d.data))\n    .on('mousedown', d => {\n      pressed = true\n      d.action(d.data)\n    })\n    .on('mouseup', () => (pressed = false))\n    .on('mouseout', () => (pressed = false))\n\n  zoomEnter\n    .append('image')\n    .attr(`class`, d => d.option)\n    .attr('width', 30)\n    .attr('height', 30)\n    .attr(`preserveAspectRatio`, 'none')\n    .attr(`xlink:href`, d => d.img)\n    // .on('click', d => d.action(d.data))\n    .on('mousedown', d => {\n      pressed = true\n      d.action(d.data)\n    })\n    .on('mouseup', () => (pressed = false))\n    .on('mouseout', () => (pressed = false))\n}\n\nfunction panControls() {\n  let buttonDistance = 30\n  let panGroup = svgContainer\n    .append('g')\n    .attr('class', 'panGroup')\n    .attr('transform', `translate(35, ${height - 65})`)\n\n  let panEnter = panGroup\n    .selectAll('g.panData')\n    .data(vueControls.panControls)\n    .enter()\n    .append('g')\n    .attr('class', 'panData')\n    .attr(\n      `transform`,\n      d =>\n        `translate(${d.translate.x * buttonDistance}, ${d.translate.y *\n          buttonDistance})`\n    )\n\n  panEnter\n    .append('circle')\n    .attr(`class`, `controlCircle`)\n    .attr('r', 17)\n    .attr('cx', 17)\n    .attr('cy', 17)\n    .on('mousedown', d => {\n      pressed = true\n      d.action(d.data)\n    })\n    .on('mouseup', () => (pressed = false))\n    .on('mouseout', () => (pressed = false))\n\n  panEnter\n    .append('image')\n    .attr(`class`, d => d.option)\n    .attr('width', 34)\n    .attr('height', 34)\n    .attr(`preserveAspectRatio`, 'none')\n    .attr(`xlink:href`, d => d.img)\n    .on('mousedown', d => {\n      pressed = true\n      d.action(d.data)\n    })\n    .on('mouseup', () => (pressed = false))\n    .on('mouseout', () => (pressed = false))\n}\nwindow.addEventListener('resize', redrawZoom)\n\nfunction redrawZoom() {\n  let svgWidth = Number(svgContainer.style(`width`).replace('px', ''))\n  zoomer.attr('width', Math.max(svgWidth, width))\n}\n\nfunction makeAbsoluteContext(element, svgDocument) {\n  return function(x, y) {\n    var offset = svgDocument.getBoundingClientRect()\n    var matrix = element.getScreenCTM()\n    return {\n      x: matrix.a * x + matrix.c * y + matrix.e - offset.left,\n      y: matrix.b * x + matrix.d * y + matrix.f - offset.top\n    }\n  }\n}\n\n// ------------- Compution functions -------------\n\nfunction updateHeightDepth(current, depth) {\n  current.depth = depth\n  let height = 0\n  if (current.children) {\n    let children = current.children\n    let heights = []\n    for (let i = 0; i < children.length; ++i) {\n      heights.push(updateHeightDepth(children[i], depth + 1))\n    }\n    height = Math.max(...heights, height) + 1\n  }\n  current.height = height\n  return height\n}\n\nfunction parentOfPinned(selected, pinned, pinnedParent) {\n  if (pinned === selected || !pinnedParent) return false\n  else if (pinnedParent === selected) return true\n  else return parentOfPinned(selected, pinned, pinnedParent.parent)\n}\n\nfunction checkParentOfPinned(selected, pinned) {\n  if (pinned) return parentOfPinned(selected, pinned, pinned.parent)\n  return false\n}\n\nfunction childOfPinned(selected, pinned) {\n  if (!selected) return false\n  else if (selected === pinned) return true\n  else return childOfPinned(selected.parent, pinned)\n}\n\n// Collapse the node and all it`s children\nfunction collapse(d) {\n  if (d.children) {\n    d._children = d.children\n    d._children.forEach(collapse)\n    d.children = null\n  }\n}\n\nexport {\n  initializerExported as initialize,\n  updateHeightDepth,\n  collapse,\n  checkParentOfPinned,\n  childOfPinned\n}\n"]}]}