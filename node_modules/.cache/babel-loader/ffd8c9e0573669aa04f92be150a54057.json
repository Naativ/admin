{"remainingRequest":"/Users/narfdre/Code/hexly/admin/node_modules/babel-loader/lib/index.js!/Users/narfdre/Code/hexly/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/narfdre/Code/hexly/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/narfdre/Code/hexly/admin/src/views/members/ContactCardPhones.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/narfdre/Code/hexly/admin/src/views/members/ContactCardPhones.vue","mtime":1581353753563},{"path":"/Users/narfdre/Code/hexly/admin/.babelrc","mtime":1546923832000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/narfdre/Code/hexly/admin/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.array.fill\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/narfdre/Code/hexly/admin/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { cloneDeep, get } from 'lodash';\nimport { ContactCardPhoneGQL, PhoneUpsert } from \"../../users/members.gql\";\nimport EditButton from \"./EditButton\";\nexport default {\n  name: 'ContactCardPhones',\n  components: {\n    EditButton: EditButton\n  },\n  data: function data() {\n    return {\n      model: null,\n      disabled: [],\n      memberId: ~~this.$route.params.id,\n      phoneTypeEnum: ['Unspecified', 'Cell', 'Business', 'Home']\n    };\n  },\n  methods: {\n    editClicked: function editClicked(index) {\n      this.setDisabled(index, false);\n    },\n    saveClicked: function () {\n      var _saveClicked = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(index) {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.$apollo.mutate({\n                  mutation: PhoneUpsert,\n                  variables: {\n                    input: {\n                      id: this.model.phoneNumbers[index].id,\n                      number: this.model.phoneNumbers[index].number,\n                      type: this.model.phoneNumbers[index].type.toUpperCase(),\n                      contactId: this.model.phoneNumbers[index].contactId\n                    }\n                  }\n                });\n\n              case 3:\n                this.$emit('snackbarEmit', 'Phone updated!');\n                _context.next = 11;\n                break;\n\n              case 6:\n                _context.prev = 6;\n                _context.t0 = _context[\"catch\"](0);\n                this.$emit('snackbarEmit', _context.t0.message);\n                console.error(_context.t0);\n                throw new Error('Error Updating phone number!');\n\n              case 11:\n                this.$apollo.queries.phones.refetch();\n                this.setDisabled(index, true);\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 6]]);\n      }));\n\n      function saveClicked(_x) {\n        return _saveClicked.apply(this, arguments);\n      }\n\n      return saveClicked;\n    }(),\n    cancelClicked: function () {\n      var _cancelClicked = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(index) {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.setDisabled(index, true);\n                _context2.next = 3;\n                return this.$apollo.queries.phones.refetch();\n\n              case 3:\n                this.initMember(this.phones);\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function cancelClicked(_x2) {\n        return _cancelClicked.apply(this, arguments);\n      }\n\n      return cancelClicked;\n    }(),\n    initMember: function initMember(contact) {\n      var _this = this;\n\n      this.model = cloneDeep(contact);\n      var _this$model$phoneNumb = this.model.phoneNumbers,\n          phoneNumbers = _this$model$phoneNumb === void 0 ? [] : _this$model$phoneNumb;\n      phoneNumbers.forEach(function (number, index) {\n        if (number.type) {\n          var newType = number.type.toLowerCase();\n          newType = newType.charAt(0).toUpperCase() + newType.slice(1);\n          _this.model.phoneNumbers[index].type = newType;\n        }\n      });\n      var disabled = Array(phoneNumbers.length).fill(true);\n      this.disabled = disabled;\n    },\n    setDisabled: function setDisabled(index, value) {\n      var _this$model$phoneNumb2 = this.model.phoneNumbers,\n          phoneNumbers = _this$model$phoneNumb2 === void 0 ? [] : _this$model$phoneNumb2;\n      var disabled = Array(phoneNumbers.length).fill(true);\n      disabled[index] = value;\n      this.disabled = disabled;\n    }\n  },\n  watch: {\n    phones: function phones(next) {\n      this.initMember(next);\n    },\n    '$route': function $route(newRoute) {\n      var id = newRoute.params.id;\n      this.memberId = ~~id;\n    }\n  },\n  apollo: {\n    phones: _objectSpread({}, ContactCardPhoneGQL, {\n      variables: function variables() {\n        return {\n          memberId: this.memberId\n        };\n      },\n      update: function update(data) {\n        var member = _objectSpread({}, get(data, 'members.nodes.0'));\n\n        var contacts = member.contacts;\n\n        if (contacts && Array.isArray(contacts) && contacts.length < 2) {\n          var phoneNumbers;\n          var parsedContacts;\n\n          if (contacts[0].phoneNumbers.length) {\n            parsedContacts = contacts[0];\n          } else {\n            phoneNumbers = [{\n              contactId: contacts[0].id,\n              id: null,\n              number: null,\n              type: null\n            }];\n            parsedContacts = _objectSpread({}, contacts[0], {\n              phoneNumbers: phoneNumbers\n            });\n          }\n\n          return parsedContacts;\n        }\n\n        return contacts;\n      }\n    })\n  }\n};",{"version":3,"sources":["ContactCardPhones.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <span v-if =\"model\">\n    <v-list-tile-sub-title\n      v-for =\"(phoneNumber, index) in model.phoneNumbers\"\n      :key  =\"index\"\n    >\n      <div class=\"title-container\">\n        <h4 class=\"contact-section-heading\">Phone {{model.phoneNumbers.length > 1 ? index+1 : null}}</h4>\n        <EditButton\n          :index         =\"index\"\n          :disabled      =\"disabled[index]\"\n          @editClicked   =\"editClicked(index)\"\n          @saveClicked   =\"saveClicked(index)\"\n          @cancelClicked =\"cancelClicked(index)\"\n        />\n      </div>\n      <div class=\"phone-details-container\">\n        <v-text-field\n          prepend-icon =\"phone\"\n          :disabled    =\"disabled[index]\"\n          v-model      =\"model.phoneNumbers[index].number\"\n          label=\"Number\"\n        />\n        <v-select\n          prepend-icon =\"phone\"\n          chips\n          label=\"Type\"\n          v-model=\"model.phoneNumbers[index].type\"\n          :regular=\"disabled[index]\"\n          :items=\"phoneTypeEnum\"\n          :disabled =\"disabled[index]\"\n          :menu-props=\"{\n            closeOnClick: false,\n            closeOnContentClick: true,\n            disableKeys: true,\n            openOnClick: false,\n            maxHeight: 304\n          }\"\n          :append-icon=\"!disabled[index] ? '$vuetify.icons.dropdown' : null\"\n        ></v-select>\n      </div>\n    </v-list-tile-sub-title>\n  </span>\n</template>\n\n<script>\nimport { cloneDeep, get } from 'lodash'\n\nimport { ContactCardPhoneGQL, PhoneUpsert } from '../../users/members.gql'\nimport EditButton from './EditButton'\n\nexport default {\n  name: 'ContactCardPhones',\n  components: {\n    EditButton\n  },\n  data () {\n    return {\n      model: null,\n      disabled: [],\n      memberId: ~~this.$route.params.id,\n      phoneTypeEnum: [\n        'Unspecified',\n        'Cell',\n        'Business',\n        'Home'\n      ]\n    }\n  },\n  methods: {\n    editClicked (index) {\n      this.setDisabled(index, false)\n    },\n    async saveClicked(index) {\n      try {\n        await this.$apollo.mutate({\n          mutation: PhoneUpsert,\n          variables: {\n            input: {\n              id: this.model.phoneNumbers[index].id,\n              number: this.model.phoneNumbers[index].number,\n              type: this.model.phoneNumbers[index].type.toUpperCase(),\n              contactId: this.model.phoneNumbers[index].contactId\n            }\n          }\n        })\n        this.$emit('snackbarEmit', 'Phone updated!')\n      } catch (error) {\n        this.$emit('snackbarEmit', error.message)\n        console.error(error)\n        throw new Error('Error Updating phone number!')\n      }\n\n      this.$apollo.queries.phones.refetch()\n\n      this.setDisabled(index, true)\n    },\n    async cancelClicked (index) {\n      this.setDisabled(index, true)\n      await this.$apollo.queries.phones.refetch()\n      this.initMember(this.phones)\n    },\n    initMember(contact) {\n      this.model = cloneDeep(contact)\n      const { phoneNumbers = [] } = this.model\n\n      phoneNumbers.forEach((number, index) => {\n        if (number.type) {\n          let newType = number.type.toLowerCase()\n          newType = newType.charAt(0).toUpperCase() + newType.slice(1)\n          this.model.phoneNumbers[index].type = newType\n        }\n      })\n\n      const disabled = Array(phoneNumbers.length).fill(true)\n      this.disabled = disabled\n    },\n    setDisabled(index, value) {\n      const { phoneNumbers = [] } = this.model\n      const disabled = Array(phoneNumbers.length).fill(true)\n\n      disabled[index] = value\n      this.disabled = disabled\n    }\n  },\n  watch: {\n    phones (next) {\n      this.initMember(next)\n    },\n    '$route'(newRoute) {\n      const { params: { id } } = newRoute\n      this.memberId = ~~id\n    }\n  },\n  apollo: {\n    phones: {\n      ...ContactCardPhoneGQL,\n      variables() {\n        return {\n          memberId: this.memberId\n        }\n      },\n      update(data) {\n        let member = { ...get(data, 'members.nodes.0') }\n        const { contacts } = member\n\n        if (contacts && Array.isArray(contacts) && contacts.length < 2) {\n          let phoneNumbers\n          let parsedContacts\n\n          if (contacts[0].phoneNumbers.length) {\n            parsedContacts = contacts[0]\n          } else {\n            phoneNumbers = [{\n              contactId: contacts[0].id,\n              id: null,\n              number: null,\n              type: null\n            }]\n            parsedContacts = { ...contacts[0], phoneNumbers }\n          }\n\n          return parsedContacts\n        }\n        return contacts\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.findme {\n  border: 2px solid red;\n}\n.details {\n  text-align: left;\n}\n.addresses {\n  display: flex;\n  flex-direction: column;\n  height: 39vh;\n  flex-wrap: wrap;\n  min-width: 45vw;\n  padding-top: 11px;\n  padding-top: 48px;\n  position: relative;\n}\n#contact-list {\n  width: 100%;\n}\n.address-title {\n  position: absolute;\n  top: 9px;\n}\n.contact-section-heading {\n  display: inline;\n}\n.title-container {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 19px;\n  align-items: center;\n}\n.phone-details-container {\n  display: flex;\n  align-items: flex-end;\n}\n</style>\n"],"sourceRoot":"src/views/members"}]}