{"remainingRequest":"/Users/narfdre/Code/hexly/admin/node_modules/babel-loader/lib/index.js!/Users/narfdre/Code/hexly/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/narfdre/Code/hexly/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/narfdre/Code/hexly/admin/src/views/users/UsersDashboard.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/narfdre/Code/hexly/admin/src/views/users/UsersDashboard.vue","mtime":1572899921000},{"path":"/Users/narfdre/Code/hexly/admin/.babelrc","mtime":1546923832000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/narfdre/Code/hexly/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"/Users/narfdre/Code/hexly/admin/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/narfdre/Code/hexly/admin/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es6.regexp.search\";\nimport _objectSpread from \"/Users/narfdre/Code/hexly/admin/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { get } from 'lodash';\nimport { mapActions, mapState } from 'vuex';\nimport { UsersActions } from '@/users/UsersStore';\nexport default {\n  data: function data() {\n    return {\n      loading: false,\n      valid: true,\n      term: '',\n      tags: [],\n      pageSize: 25,\n      index: 1,\n      length: 0\n    };\n  },\n  methods: _objectSpread({}, mapActions([UsersActions.FETCH_USERS]), {\n    open: function open(user) {\n      this.$router.push('/members/' + user.id);\n    },\n    resetIndexSearch: function resetIndexSearch() {\n      this.index = 1;\n      this.search();\n    },\n    search: function () {\n      var _search = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var term, tags;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.loading = true;\n                term = this.term, tags = this.tags;\n                _context.next = 4;\n                return this.usersFetch({\n                  term: term,\n                  tags: tags.map(function (e) {\n                    return e.name;\n                  }),\n                  first: this.pageSize,\n                  after: (this.index - 1) * this.pageSize\n                });\n\n              case 4:\n                this.loading = false;\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function search() {\n        return _search.apply(this, arguments);\n      }\n\n      return search;\n    }(),\n    resetIndexRemove: function resetIndexRemove(item) {\n      this.index = 1;\n      this.remove(item);\n    },\n    remove: function remove(item) {\n      this.loading = true;\n      this.tags.splice(this.tags.indexOf(item), 1);\n      this.tags = _toConsumableArray(this.tags);\n      this.search();\n      this.loading = false;\n    },\n    getEmail: function getEmail(item) {\n      return get(item, 'contacts[0].emails[0].email', 'No Email for this user');\n    }\n  }),\n  computed: _objectSpread({}, mapState({\n    searched: function searched(state) {\n      return state.users.searched;\n    },\n    availableTags: function availableTags(state) {\n      return state.tenants.tags;\n    }\n  })),\n  watch: {\n    searched: function searched(newVal) {\n      this.length = Math.ceil(newVal.totalResults / this.pageSize);\n    },\n    index: function index(newVal) {\n      this.search();\n    }\n  }\n};",{"version":3,"sources":["UsersDashboard.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4FA,SAAA,GAAA,QAAA,QAAA;AACA,SAAA,UAAA,EAAA,QAAA,QAAA,MAAA;AACA,SAAA,YAAA,QAAA,oBAAA;AAEA,eAAA;AACA,MADA,kBACA;AACA,WAAA;AACA,eAAA,KADA;AAEA,aAAA,IAFA;AAGA,YAAA,EAHA;AAIA,YAAA,EAJA;AAKA,gBAAA,EALA;AAMA,aAAA,CANA;AAOA,cAAA;AAPA,KAAA;AASA,GAXA;AAYA,6BACA,WAAA,CAAA,aAAA,WAAA,CAAA,CADA;AAEA,QAFA,gBAEA,IAFA,EAEA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA,cAAA,KAAA,EAAA;AACA,KAJA;AAKA,oBALA,8BAKA;AACA,WAAA,KAAA,GAAA,CAAA;AACA,WAAA,MAAA;AACA,KARA;AASA,UATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA,qBAAA,OAAA,GAAA,IAAA;AACA,oBAXA,GAWA,IAXA,CAWA,IAXA,EAWA,IAXA,GAWA,IAXA,CAWA,IAXA;AAAA;AAAA,uBAYA,KAAA,UAAA,CAAA;AAAA,4BAAA;AAAA,wBAAA,KAAA,GAAA,CAAA;AAAA,2BAAA,EAAA,IAAA;AAAA,mBAAA,CAAA;AAAA,yBAAA,KAAA,QAAA;AAAA,yBAAA,CAAA,KAAA,KAAA,GAAA,CAAA,IAAA,KAAA;AAAA,iBAAA,CAZA;;AAAA;AAaA,qBAAA,OAAA,GAAA,KAAA;;AAbA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAeA,oBAfA,4BAeA,IAfA,EAeA;AACA,WAAA,KAAA,GAAA,CAAA;AACA,WAAA,MAAA,CAAA,IAAA;AACA,KAlBA;AAmBA,UAnBA,kBAmBA,IAnBA,EAmBA;AACA,WAAA,OAAA,GAAA,IAAA;AACA,WAAA,IAAA,CAAA,MAAA,CAAA,KAAA,IAAA,CAAA,OAAA,CAAA,IAAA,CAAA,EAAA,CAAA;AACA,WAAA,IAAA,sBAAA,KAAA,IAAA;AACA,WAAA,MAAA;AACA,WAAA,OAAA,GAAA,KAAA;AACA,KAzBA;AA0BA,YA1BA,oBA0BA,IA1BA,EA0BA;AACA,aAAA,IAAA,IAAA,EAAA,6BAAA,EAAA,wBAAA,CAAA;AACA;AA5BA,IAZA;AA0CA,8BACA,SAAA;AACA,cAAA;AAAA,aAAA,MAAA,KAAA,CAAA,QAAA;AAAA,KADA;AAEA,mBAAA;AAAA,aAAA,MAAA,OAAA,CAAA,IAAA;AAAA;AAFA,GAAA,CADA,CA1CA;AAgDA,SAAA;AACA,YADA,oBACA,MADA,EACA;AACA,WAAA,MAAA,GAAA,KAAA,IAAA,CAAA,OAAA,YAAA,GAAA,KAAA,QAAA,CAAA;AACA,KAHA;AAIA,SAJA,iBAIA,MAJA,EAIA;AACA,WAAA,MAAA;AACA;AANA;AAhDA,CAAA","sourcesContent":["<template>\n  <v-card class=\"main-card\">\n    <v-card-title primary-title>\n      <v-flex xs12>\n        <v-form @submit.prevent=\"resetIndexSearch\" ref=\"form\" v-model=\"valid\" lazy-validation>\n          <v-layout>\n            <v-flex xs9>\n              <v-flex xs12>\n                <v-text-field required v-model=\"term\" label=\"Search Term\"></v-text-field>\n              </v-flex>\n              <v-flex xs12>\n                <v-combobox\n                  chips\n                  :disabled=\"availableTags.loading\"\n                  @input=\"resetIndexSearch\"\n                  :items=\"availableTags.values\"\n                  item-text=\"name\"\n                  item-value=\"id\"\n                  label=\"Tags\"\n                  :loading=\"loading\"\n                  v-model=\"tags\"\n                  multiple\n                  solo\n                >\n                  <template slot=\"selection\" slot-scope=\"data\">\n                    <v-chip\n                      :key=\"'s' + data.item.id\"\n                      :selected=\"data.selected\"\n                      @input=\"resetIndexRemove(data.item)\"\n                      close\n                    >\n                      <strong>{{ data.item.name }}</strong>&nbsp;\n                    </v-chip>\n                  </template>\n                </v-combobox>\n              </v-flex>\n            </v-flex>\n            <v-flex d-flex xs3 child-flex>\n              <v-btn\n                type=\"submit\"\n                :disabled=\"!valid\"\n                :loading=\"loading\"\n                @click=\"resetIndexSearch\"\n              >submit</v-btn>\n            </v-flex>\n          </v-layout>\n        </v-form>\n      </v-flex>\n    </v-card-title>\n    <!-- Search Results -->\n    <v-card-text>\n      <div class=\"text-xs-center\" v-if=\"loading\">\n        <v-progress-circular indeterminate color=\"primary\"></v-progress-circular>\n      </div>\n      <v-list v-if=\"!loading\" two-line>\n        <template v-for=\"item in searched.results\">\n          <v-list-tile :key=\"item.id\" avatar @click=\"open(item)\">\n            <v-list-tile-avatar>\n              <img :src=\"item.profileUrl\" v-if=\"item.profileUrl\" />\n              <v-icon v-else>person</v-icon>\n            </v-list-tile-avatar>\n            <v-list-tile-content>\n              <v-list-tile-title>{{item.displayName}}</v-list-tile-title>\n              <v-list-tile-sub-title>\n                <v-layout row wrap>\n                  <v-flex xs6 sm3>MRN: {{item.mrn}}</v-flex>\n                  <v-flex xs6 sm3>System ID: {{item.id}}</v-flex>\n                  <v-flex xs6 sm3>Email: {{getEmail(item)}}</v-flex>\n                  <v-flex xs6 sm3 class=\"align-right\">\n                    <v-tooltip left>\n                      <a slot=\"activator\">{{item.tags.length}} tags</a>\n                      <v-list>\n                        <v-list-tile v-for=\"(tag, index) in item.tags\" :key=\"index\">\n                          <v-list-tile-title>{{ tag }}</v-list-tile-title>\n                        </v-list-tile>\n                      </v-list>\n                    </v-tooltip>\n                  </v-flex>\n                </v-layout>\n              </v-list-tile-sub-title>\n            </v-list-tile-content>\n          </v-list-tile>\n        </template>\n      </v-list>\n      <v-layout justify-space-around align-center>\n        <v-pagination v-if=\"length >= 1 && !loading\" v-model=\"index\" :length=\"length\"></v-pagination>\n      </v-layout>\n    </v-card-text>\n  </v-card>\n</template>\n\n<script>\nimport { get } from 'lodash'\nimport { mapActions, mapState } from 'vuex'\nimport { UsersActions } from '@/users/UsersStore'\n\nexport default {\n  data () {\n    return {\n      loading: false,\n      valid: true,\n      term: '',\n      tags: [],\n      pageSize: 25,\n      index: 1,\n      length: 0\n    }\n  },\n  methods: {\n    ...mapActions([UsersActions.FETCH_USERS]),\n    open (user) {\n      this.$router.push('/members/' + user.id)\n    },\n    resetIndexSearch () {\n      this.index = 1\n      this.search()\n    },\n    async search () {\n      this.loading = true\n      const { term, tags } = this\n      await this.usersFetch({ term, tags: tags.map(e => e.name), first: this.pageSize, after: (this.index - 1) * this.pageSize })\n      this.loading = false\n    },\n    resetIndexRemove (item) {\n      this.index = 1\n      this.remove(item)\n    },\n    remove (item) {\n      this.loading = true\n      this.tags.splice(this.tags.indexOf(item), 1)\n      this.tags = [...this.tags]\n      this.search()\n      this.loading = false\n    },\n    getEmail(item) {\n      return get(item, 'contacts[0].emails[0].email', 'No Email for this user')\n    }\n  },\n  computed: {\n    ...mapState({\n      searched: state => state.users.searched,\n      availableTags: state => state.tenants.tags\n    })\n  },\n  watch: {\n    searched (newVal) {\n      this.length = Math.ceil(newVal.totalResults / this.pageSize)\n    },\n    index (newVal) {\n      this.search()\n    }\n  }\n}\n</script>\n\n<style scoped>\n.full-height {\n  height: 77% !important;\n}\n.main-card {\n  min-height: calc(100vh - 200px);\n}\n</style>\n"],"sourceRoot":"src/views/users"}]}